from notifier import send_telegram_message, send_push_message
from config import TAKE_PROFIT, MAX_SLIPPAGE, PRIORITY_FEE_ENABLED

def analyze_and_trade(token_info):
    try:
        symbol = token_info.get("symbol")
        liquidity = token_info.get("liquidity")
        holders = token_info.get("holders")
        insider_risk = token_info.get("insider_risk", False)

        # –§–∏–ª—å—Ç—Ä –ø–æ —Ä–∏—Å–∫–∞–º
        if insider_risk or liquidity < 1000:
            print(f"[SKIP] {symbol} ‚Äî —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω")
            return

        # –ê–Ω–∞–ª–∏–∑ –∏ –≤—Ö–æ–¥
        print(f"[TRADE] –í—Ö–æ–∂—É –≤ {symbol}")
        send_telegram_message(f"üöÄ –í—Ö–æ–¥ –≤ {symbol}")
        send_push_message(f"üöÄ –í—Ö–æ–¥ –≤ {symbol}")

        # TODO: –ó–¥–µ—Å—å –±—É–¥–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π –≤—Ö–æ–¥ –≤ —Å–¥–µ–ª–∫—É —á–µ—Ä–µ–∑ RPC

        # –ú–Ω–∏–º—ã–π Take Profit (–¥–ª—è –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞)
        print(f"[TAKE PROFIT] –í—ã—Ö–æ–¥ –∏–∑ {symbol} –ø—Ä–∏ x{TAKE_PROFIT}")
        send_push_message(f"‚úÖ –°–¥–µ–ª–∫–∞ –ø–æ {symbol} –∑–∞–∫—Ä—ã—Ç–∞ (TP x{TAKE_PROFIT})")

    except Exception as e:
        print(f"[Trader Error] {e}")
